<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Joey‚Äôs Acoustic Corner ‚Äî Sessions</title>

  <link rel="stylesheet" href="./styles.css" />

  <!-- optional: makes refreshes show updated files faster -->
  <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate" />
  <meta http-equiv="Pragma" content="no-cache" />
  <meta http-equiv="Expires" content="0" />
</head>

<body class="sessions">

  <!-- TOP BAR -->
  <header class="top">
    <div class="brand">
      <div class="brandMark"></div>
      <div class="brandText">
        <div class="titleRow">
          <div class="title">JOEY‚ÄôS ACOUSTIC CORNER</div>
          <div class="liveBadge"><span class="liveDot"></span> LIVE</div>
        </div>
        <div class="sub">
          <span class="subStrong">Stripped & unplugged sessions</span>
          <span class="subSep">‚Äî</span>
          <span>handpicked only.</span>
        </div>
      </div>
    </div>
  </header>

  <main class="wrap">

    <!-- Back to home -->
    <a href="./index.html" class="focusToggleBtn" style="justify-content:center;">
      ‚Üê Back to home
    </a>

    <!-- PLAYER -->
    <section id="playerWrap" class="player-wrap player-wrap--collapsible">
      <div class="now-playing-title" id="nowPlayingTitle">Now Playing</div>

      <div class="tvFrame">
        <div class="tvTopBar">
          <div class="tvLabel">JOEY‚ÄôS ACOUSTIC CORNER</div>

          <!-- PLAYER TOGGLE BUTTON -->
          <button id="playerToggleBtn" class="sessionOverlayClose" type="button" aria-expanded="true">
            Hide player
          </button>
        </div>

        <div class="playerFrameWrap" id="playerFrameWrap">
          <!-- IMPORTANT: app.js controls this iframe src -->
          <iframe
            id="playerFrame"
            class="player-frame"
            src=""
            title="Player"
            allow="autoplay; encrypted-media; picture-in-picture"
            allowfullscreen
            referrerpolicy="strict-origin-when-cross-origin"
          ></iframe>
        </div>

        <div id="nowPlayingLine" style="padding: 10px 14px 12px; opacity:.75; font-weight:700;">
          Playing now.
        </div>
      </div>
    </section>

    <!-- SESSIONS LIST -->
    <section id="sessionsList">
      <div class="sessionsHead">
        <div>
          <div class="sessionsTitle">Sessions</div>
          <div class="sessionsSub">Pick a set. If it‚Äôs a queue, it stitches tracks together for you.</div>
        </div>
        <div id="status">Loading‚Ä¶</div>
      </div>

      <div id="episodes"></div>
    </section>

    <!-- Optional: overlay container (if your app.js uses it, this enables it; if not, it just sits idle) -->
    <div class="sessionOverlay" aria-hidden="true">
      <div class="sessionOverlayCard">
        <div class="sessionOverlayHead">
          <div class="sessionOverlayTitle">Change Session</div>
          <button class="sessionOverlayClose" type="button" onclick="document.body.classList.remove('showSessions')">
            Close
          </button>
        </div>
        <div class="sessionOverlayBody" id="sessionOverlayBody"></div>
      </div>
    </div>

  </main>

  <!-- üî• FIX: correct episodes path (yours is /data/episodes.js) -->
  <script src="./data/episodes.js"></script>

  <!-- your app logic -->
  <script src="./app.js"></script>

  <!-- Player collapse/expand (does NOT touch autoplay/queue logic) -->
  <script>
    (function () {
      const btn = document.getElementById("playerToggleBtn");
      const wrap = document.getElementById("playerWrap");

      function setCollapsed(isCollapsed) {
        document.body.classList.toggle("playerCollapsed", isCollapsed);
        btn.textContent = isCollapsed ? "Show player" : "Hide player";
        btn.setAttribute("aria-expanded", String(!isCollapsed));
      }

      // start expanded (change to true if you want it collapsed by default)
      setCollapsed(false);

      btn.addEventListener("click", function () {
        setCollapsed(!document.body.classList.contains("playerCollapsed"));
      });

      // OPTIONAL SMART BEHAVIOR:
      // Auto-collapse when you scroll into the sessions list on phones.
      // It won‚Äôt affect playback; it just stops the player from blocking taps.
      const sessions = document.getElementById("sessionsList");
      if ("IntersectionObserver" in window && sessions) {
        const io = new IntersectionObserver((entries) => {
          entries.forEach((e) => {
            if (e.isIntersecting) setCollapsed(true);
          });
        }, { threshold: 0.35 });
        io.observe(sessions);
      }
    })();
  </script>

</body>
</html>
